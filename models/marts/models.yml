version: 2

models:
  - name: dim_date
    description: "Date dimension generated by dbt_utils.date_spine"
    columns:
      - name: date_key
      - name: full_date
      - name: year
      - name: month
      - name: day
      - name: week_of_year
      - name: day_of_year
      - name: quarter_of_year
      - name: day_of_week
      - name: month_name
      - name: day_name
      - name: is_last_day_of_month
      - name: is_weekend

  - name: dim_order_status
    columns:
      - name: order_status_key
        tests:
          - unique
          - not_null
      - name: order_status
      - name: order_status_name

  - name: obt_sales
    description: "One Big Table table joining fact_sales to dimensions"
    columns:
      - name: order_date
        description: "Order date (partition field)"
      - name: product_key
      - name: customer_key
      - name: credit_card_key
      - name: ship_address_key
      - name: order_status_key
      - name: order_date_key

  - name: dim_address
    description: "Address dimension"
    columns:
      - name: address_key
        tests:
          - unique
          - not_null
      - name: address_id
      - name: city
      - name: state
      - name: country

  - name: dim_credit_card
    description: "Credit card dimension"
    columns:
      - name: credit_card_key
        tests: 
          - unique
          - not_null
      - name: credit_card_id
      - name: card_type

  - name: dim_customer
    description: "Customer dimension with denormalized person info"
    columns:
      - name: customer_key
        tests: 
          - unique
          - not_null
      - name: customer_id
      - name: person_business_entity_id
      - name: full_name
      - name: total_purchase_ytd
      - name: date_first_purchase
      - name: birth_date
      - name: marital_status
      - name: yearly_income
      - name: gender
      - name: total_children
      - name: number_children_at_home
      - name: education
      - name: occupation
      - name: home_owner_flag
      - name: number_cars_owned
      - name: commute_distance

  - name: fact_sales
    description: "Sales fact table"
    columns:
      - name: sales_key
        tests:
          - unique
          - not_null
      - name: product_key
      - name: customer_key
      - name: credit_card_key
      - name: ship_address_key
      - name: order_status_key
      - name: order_date_key
      - name: order_date
      - name: unit_price
      - name: unit_price_discount
      - name: cost_of_goods_sold
      - name: order_quantity
      - name: gross_revenue
      - name: gross_profit

  - name: dim_product
    description: "Product dimension"
    columns:
      - name: product_key
        tests: 
          - unique
          - not_null
      - name: product_id
      - name: product_name
      - name: product_number
      - name: color
      - name: class
      - name: product_subcategory_name
      - name: product_category_name
